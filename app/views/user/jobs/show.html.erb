<div class="container">
  <header class="row">
    <div class="col s12 m12 l12 left-align">
      <%= link_to "Â« Back to #{@job.category.name}",
                  category_path(@job.category),
                  class: "back-to-category-link" %>
    </div>
  </header>

  <%= render partial: "job_details" %>

  <div class="row left-align">
    <div class="col s12 m12 l12">
      <% if logged_in? %>
        <%= render partial: "bid_accordion" %>
      <% else %>
        <div class="log-in-to-bid">
          <%= link_to "Log In To Place A Bid", login_path %>
        </div>
      <% end %>
    </div>
  </div>
  <section class="row" style="display:none;">
    <!-- ^^^ REMOVE DISPLAY NONE FROM HERE IN THE FUTURE ^^^ -->
    <h4 class="bids-table-title">Current Bids</h4>
    <table class="striped responsive">
      <thead>
        <tr>
          <th>Bidder Name</th>
          <th>Price</th>
          <th>Duration Estimate</th>
          <th>Comment</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Toni Rib</td>
          <td>$500</td>
          <td>2 weeks</td>
          <td>I can totally build this table because I am super awesome!</td>
          <td>
            <a href="#" class="action-link">Edit</a> |
            <a href="#" class="action-link">Delete</a>
          </td>
        </tr>
        <tr>
          <td>Aaron Greenspan</td>
          <td>$700</td>
          <td>1 week</td>
          <td>I am an expert craftsman and I will build you a beautiul oak table in no time at all.</td>
          <td><a href=# class="action-link">Accept</a></td>
        </tr>
      </tbody>
    </table>
  </section>

  <%= render partial: "lister_details" %>
</div>

<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

<script type="text/javascript">
  $( "#accordion" ).accordion({
    animate: 200,
    active: false,
    collapsible: true,
    heightStyle: "content",
    autoHeight: false
  });
</script>

<%= javascript_tag do %>
  var map;
  function initMap() {
    map = new google.maps.Map(document.getElementById('google-map'), {
      zoom: 13
    });

    var zipcode = <%= @job.zipcode %>;

    geocoder = new google.maps.Geocoder();
    geocoder.geocode( { 'address': 'zipcode' }, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
    })
  }
<% end %>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDm1nN_vOXj6XM6U8rRNaBDAcprgDB1pkM&callback=initMap"
async defer></script>
